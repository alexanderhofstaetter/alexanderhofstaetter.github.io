<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.34.1">
    <meta name="project" content="PVE v0.0.1">


    <title>Owat.Model â€” PVE v0.0.1</title>
    <link rel="stylesheet" href="dist/html-elixir-VEFCVPF3.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-FE64E7E5.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-7XSQ4GTY.js"></script>

  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
PVE
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.0.1
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


        <li>
          <button id="tasks-list-tab-button" role="tab" data-type="tasks" aria-controls="tasks-tab-panel" aria-selected="false" tabindex="-1">
            <span translate="no">Mix</span> Tasks
          </button>
        </li>

    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


    <div id="tasks-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="tasks-list-tab-button" hidden>
      <ul id="tasks-full-list" class="full-list"></ul>
    </div>

</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of PVE</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

    <span translate="no">Owat.Model</span> 
    <small class="app-vsn" translate="no">(PVE v0.0.1)</small>

  </h1>


    <section id="moduledoc">
<p>Base functionality for models that get sent over the websocket connection.</p><p>When used this module will import the <code class="inline">datatype</code> which will do the following
when invoked:</p><ul><li>Generate a <code class="inline">datamap</code> function that consumes the struct of the
caller and produces a stripped map according to the given rules in the do
block</li><li>Generate a zod schema file for each datatype that is used in the module</li></ul><h2 id="module-usage" class="section-heading">
  <a href="#module-usage" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Usage</span>
</h2>
<p>Generally a list of <code class="inline">:-&gt;</code> expressions is given that specify which keys the
resulting map shall have.</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="5910696756-1">do</span><span class="w">
  </span><span class="ss">:resulting_field_name</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="ss">:struct_field</span><span class="w">
</span><span class="k" data-group-id="5910696756-1">end</span></code></pre><p>This will produce the function <code class="inline">fn_name/1</code> like this:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">fn_name</span><span class="p" data-group-id="1378039792-1">(</span><span class="n">internal_name</span><span class="p" data-group-id="1378039792-1">)</span><span class="w"> </span><span class="k" data-group-id="1378039792-2">do</span><span class="w">
  </span><span class="p" data-group-id="1378039792-3">%{</span><span class="w">
    </span><span class="ss">resulting_field_name</span><span class="p">:</span><span class="w"> </span><span class="n">internal_name</span><span class="o">.</span><span class="n">struct_field</span><span class="w">
  </span><span class="p" data-group-id="1378039792-3">}</span><span class="w">
</span><span class="k" data-group-id="1378039792-2">end</span></code></pre><h3 id="module-complex-sub-fields" class="section-heading">
  <a href="#module-complex-sub-fields" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Complex Sub-Fields</span>
</h3>
<p>When the model has complex sub-fields, a parenthesized subexpression can be
given. This subexpression gives the struct field name and the corresponding
type module. These fields are interpreted as optional if not specified
otherwise.</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="5365698889-1">do</span><span class="w">
  </span><span class="ss">:resulting_field_name</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="ss">:struct_field</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="5365698889-2">(</span><span class="p" data-group-id="5365698889-2">)</span><span class="w">
</span><span class="k" data-group-id="5365698889-1">end</span><span class="w">

</span><span class="c1"># ===&gt;</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">fn_name</span><span class="p" data-group-id="5365698889-3">(</span><span class="n">internal_name</span><span class="p" data-group-id="5365698889-3">)</span><span class="w"> </span><span class="k" data-group-id="5365698889-4">do</span><span class="w">
  </span><span class="p" data-group-id="5365698889-5">%{</span><span class="w">
    </span><span class="ss">resulting_field_name</span><span class="p">:</span><span class="w"> </span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="5365698889-6">(</span><span class="n">internal_name</span><span class="o">.</span><span class="n">struct_field</span><span class="p" data-group-id="5365698889-6">)</span><span class="w">
  </span><span class="p" data-group-id="5365698889-5">}</span><span class="w">
</span><span class="k" data-group-id="5365698889-4">end</span></code></pre><p>When additional values need to be passed the following method is used to pass them:</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="4657100549-1">do</span><span class="w">
  </span><span class="ss">:resulting_field_name</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="ss">:struct_field</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="4657100549-2">(</span><span class="s">&quot;supplemental&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;arguments&quot;</span><span class="p" data-group-id="4657100549-2">)</span><span class="w">
</span><span class="k" data-group-id="4657100549-1">end</span><span class="w">

</span><span class="c1"># ===&gt;</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">fn_name</span><span class="p" data-group-id="4657100549-3">(</span><span class="n">internal_name</span><span class="p" data-group-id="4657100549-3">)</span><span class="w"> </span><span class="k" data-group-id="4657100549-4">do</span><span class="w">
  </span><span class="p" data-group-id="4657100549-5">%{</span><span class="w">
    </span><span class="ss">resulting_field_name</span><span class="p">:</span><span class="w"> </span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="4657100549-6">(</span><span class="n">struct</span><span class="o">.</span><span class="n">struct_field</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4657100549-7">[</span><span class="s">&quot;supplemental&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;arguments&quot;</span><span class="p" data-group-id="4657100549-7">]</span><span class="p" data-group-id="4657100549-6">)</span><span class="w">
  </span><span class="p" data-group-id="4657100549-5">}</span><span class="w">
</span><span class="k" data-group-id="4657100549-4">end</span></code></pre><p>This method of producing a value for a subfield by the subfields module can
also be used when in need to produce lists. In this case the module atom or
module invocation has to be placed in list brackets. This is also required in
order to ensure that the zod type validation adapts to an array type.</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="7960740772-1">do</span><span class="w">
  </span><span class="ss">:without_arguments</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">:field_a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="p" data-group-id="7960740772-2">[</span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="7960740772-3">(</span><span class="p" data-group-id="7960740772-3">)</span><span class="p" data-group-id="7960740772-2">]</span><span class="w">
  </span><span class="ss">:with_arguments</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">:field_b</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="p" data-group-id="7960740772-4">[</span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="7960740772-5">(</span><span class="s">&quot;supplemental&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;arguments&quot;</span><span class="p" data-group-id="7960740772-5">)</span><span class="p" data-group-id="7960740772-4">]</span><span class="w">
</span><span class="k" data-group-id="7960740772-1">end</span><span class="w">

</span><span class="c1"># ===&gt;</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">fn_name</span><span class="p" data-group-id="7960740772-6">(</span><span class="n">internal_name</span><span class="p" data-group-id="7960740772-6">)</span><span class="w"> </span><span class="k" data-group-id="7960740772-7">do</span><span class="w">
  </span><span class="p" data-group-id="7960740772-8">%{</span><span class="w">
    </span><span class="ss">without_arguments</span><span class="p">:</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="7960740772-9">(</span><span class="n">struct</span><span class="o">.</span><span class="n">field_a</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Module</span><span class="o">.</span><span class="n">datatype_fn</span><span class="p" data-group-id="7960740772-10">(</span><span class="ni">&amp;1</span><span class="p" data-group-id="7960740772-10">)</span><span class="p" data-group-id="7960740772-9">)</span><span class="w">
    </span><span class="ss">with_arguments</span><span class="p">:</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="7960740772-11">(</span><span class="n">struct</span><span class="o">.</span><span class="n">field_b</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Module</span><span class="o">.</span><span class="n">get_list</span><span class="p" data-group-id="7960740772-12">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7960740772-13">[</span><span class="s">&quot;supplemental&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;arguments&quot;</span><span class="p" data-group-id="7960740772-13">]</span><span class="p" data-group-id="7960740772-12">)</span><span class="p" data-group-id="7960740772-11">)</span><span class="w">
  </span><span class="p" data-group-id="7960740772-8">}</span><span class="w">
</span><span class="k" data-group-id="7960740772-7">end</span></code></pre><h3 id="module-type-overrides-and-optionals" class="section-heading">
  <a href="#module-type-overrides-and-optionals" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Type overrides and optionals</span>
</h3>
<p>When a field's type cannot be automatically inferred or the type does not
support zod typing, a type override can be specified.</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="0399049782-1">do</span><span class="w">
  </span><span class="ss">:resulting_field_name</span><span class="p">,</span><span class="w"> </span><span class="nc">TypeOverride</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="ss">:struct_field</span><span class="w">
</span><span class="k" data-group-id="0399049782-1">end</span></code></pre><p>When a field is optional the left side of the arrow shall be wrapped in a
call to optional:</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="8102270545-1">do</span><span class="w">
  </span><span class="n">optional</span><span class="p" data-group-id="8102270545-2">(</span><span class="ss">:simple</span><span class="p" data-group-id="8102270545-2">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="ss">:struct_field_a</span><span class="w">

  </span><span class="n">optional</span><span class="p" data-group-id="8102270545-3">(</span><span class="ss">:with_type_override</span><span class="p">,</span><span class="w"> </span><span class="nc">TypeOverride</span><span class="p" data-group-id="8102270545-3">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="ss">:struct_field_b</span><span class="w">
</span><span class="k" data-group-id="8102270545-1">end</span></code></pre><h3 id="module-precomputed-values" class="section-heading">
  <a href="#module-precomputed-values" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Precomputed values</span>
</h3>
<p>Values of the resulting data map can also be arbitrary code. This is done by
wrapping the expression with the pin operator.</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="w"> </span><span class="k" data-group-id="3659620958-1">do</span><span class="w">
  </span><span class="ss">:result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">^</span><span class="nc">Module</span><span class="o">.</span><span class="n">call</span><span class="p" data-group-id="3659620958-2">(</span><span class="p" data-group-id="3659620958-2">)</span><span class="w">
</span><span class="k" data-group-id="3659620958-1">end</span></code></pre><p>The struct is generally invisible. When the value depends on the struct it
has to be made visible. This is done with the <code class="inline">:binds</code> option that also
allows precomputing values to be used in multiple fields.</p><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="p">,</span><span class="w"> </span><span class="ss">binds</span><span class="p">:</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="k" data-group-id="3452397130-1">do</span><span class="w">
  </span><span class="ss">:result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">^</span><span class="nc">Module</span><span class="o">.</span><span class="n">call</span><span class="p" data-group-id="3452397130-2">(</span><span class="n">struct</span><span class="p" data-group-id="3452397130-2">)</span><span class="w">
</span><span class="k" data-group-id="3452397130-1">end</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">datatype</span><span class="w"> </span><span class="ss">:fn_name</span><span class="p">,</span><span class="w"> </span><span class="ss">binds</span><span class="p">:</span><span class="w">
        </span><span class="p" data-group-id="4099140272-1">(</span><span class="n">struct</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Module</span><span class="o">.</span><span class="n">call</span><span class="p" data-group-id="4099140272-2">(</span><span class="n">struct</span><span class="p" data-group-id="4099140272-2">)</span><span class="w">
        </span><span class="p" data-group-id="4099140272-1">)</span><span class="w"> </span><span class="k" data-group-id="4099140272-3">do</span><span class="w">
  </span><span class="ss">:a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">^</span><span class="n">variable</span><span class="o">.</span><span class="n">a</span><span class="w">
  </span><span class="ss">:b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">^</span><span class="n">variable</span><span class="o">.</span><span class="n">b</span><span class="w">
</span><span class="k" data-group-id="4099140272-3">end</span></code></pre>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#datatype/3" data-no-tooltip translate="no">datatype(name, opts \\ [], list)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#newest/1" data-no-tooltip translate="no">newest(list)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#newest/2" data-no-tooltip translate="no">newest(list, key)</a>

      </div>

    </div>

</div>

  </section>


  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="datatype/3">

    <span id="datatype/2"></span>

  <div class="detail-header">
    <a href="#datatype/3" class="detail-link" data-no-tooltip title="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature" translate="no">datatype(name, opts \\ [], list)</h1>


      <span class="note">(macro)</span>

  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="newest/1">

  <div class="detail-header">
    <a href="#newest/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">newest(list)</h1>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="newest/2">

  <div class="detail-header">
    <a href="#newest/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">newest(list, key)</h1>


  </div>

  <section class="docstring">


  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="PVE.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.34.1) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
